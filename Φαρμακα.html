<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <title>Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· Î¦Î±ÏÎ¼Î¬ÎºÏ‰Î½</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #f5f5fb;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
    }

    .container {
      max-width: 900px;
      width: 100%;
      padding: 24px;
      margin: 24px;
      background: #ffffff;
      border-radius: 18px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
    }

    h1 {
      font-size: 1.6rem;
      margin-bottom: 0.5rem;
    }

    p {
      margin-top: 0.2rem;
      color: #555;
    }

    .file-row,
    .search-row {
      margin-top: 16px;
      margin-bottom: 16px;
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      align-items: center;
    }

    label {
      font-weight: 600;
    }

    input[type="file"] {
      font-size: 0.9rem;
    }

    input[type="text"] {
      flex: 1;
      min-width: 220px;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 0.95rem;
    }

    button {
      padding: 8px 16px;
      border-radius: 999px;
      border: none;
      background: #5a5ee6;
      color: white;
      font-weight: 600;
      cursor: pointer;
      font-size: 0.95rem;
    }

    button:disabled {
      background: #aaa;
      cursor: not-allowed;
    }

    .status {
      margin-top: 6px;
      font-size: 0.88rem;
      color: #666;
    }

    .results {
      margin-top: 20px;
      max-height: 500px;
      overflow-y: auto;
      border-radius: 12px;
      border: 1px solid #e2e2f0;
      padding: 12px;
      background: #fafafe;
      white-space: pre-wrap; /* Î³Î¹Î± multiline text */
      font-family: "Cascadia Code", "Fira Code", monospace;
      font-size: 0.9rem;
    }

    .result-block {
      padding: 10px 12px;
      margin-bottom: 12px;
      border-radius: 10px;
      background: #ffffff;
      border: 1px solid #e0e0ff;
    }

    .result-block:nth-child(odd) {
      background: #f9f9ff;
    }

    .divider {
      margin: 8px 0;
      height: 1px;
      background: linear-gradient(to right, transparent, #ddd, transparent);
    }

    .no-results {
      color: #aa3344;
      font-weight: 600;
    }

    mark {
      background: #fff59d;
      padding: 0 1px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ” Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ· ÏƒÎµ Î¦Î‘Î¡ÎœÎ‘ÎšÎ‘.txt</h1>
    <p>
      1ï¸âƒ£ ÎšÎ¬Î½Îµ <strong>Upload</strong> Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿ <code>Î¦Î‘Î¡ÎœÎ‘ÎšÎ‘.txt</code> (UTF-8)<br />
      2ï¸âƒ£ Î“ÏÎ¬ÏˆÎµ ÏŒÎ½Î¿Î¼Î± Ï†Î±ÏÎ¼Î¬ÎºÎ¿Ï… Î® Ï„Î¼Î®Î¼Î± Ï„Î¿Ï… (Ï€.Ï‡. "Î´Î¹Î³Î¿Î¾", "ÏƒÎ±Î»Î²Î¿Ï…Ï„Î±Î¼")<br />
      3ï¸âƒ£ Î Î¬Ï„Î·ÏƒÎµ <strong>Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·</strong>
    </p>

    <div class="file-row">
      <label for="fileInput">ğŸ“‚ Î‘ÏÏ‡ÎµÎ¯Î¿:</label>
      <input type="file" id="fileInput" accept=".txt" />
    </div>
    <div class="status" id="status">âš ï¸ Î”ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ Î±ÎºÏŒÎ¼Î· Î±ÏÏ‡ÎµÎ¯Î¿.</div>

    <div class="search-row">
      <input type="text" id="queryInput" placeholder="Î .Ï‡. Î”Î¹Î³Î¿Î¾Î¯Î½Î·, Î£Î±Î»Î²Î¿Ï…Ï„Î±Î¼ÏŒÎ»Î·, Î ÎµÎ½Î¹ÎºÎ¹Î»Î»Î¯Î½Î·..." />
      <button id="searchBtn" disabled>Î‘Î½Î±Î¶Î®Ï„Î·ÏƒÎ·</button>
    </div>

    <div class="results" id="results">
      ğŸ” Î¤Î± Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± Ï„Î·Ï‚ Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·Ï‚ Î¸Î± ÎµÎ¼Ï†Î±Î½Î¹ÏƒÏ„Î¿ÏÎ½ ÎµÎ´Ï.
    </div>
  </div>

  <script>
    let lines = [];
    const contextLines = 3; // Ï€ÏŒÏƒÎµÏ‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï€ÏÎ¹Î½/Î¼ÎµÏ„Î¬ Î´ÎµÎ¯Ï‡Î½Î¿Ï…Î¼Îµ

    const fileInput = document.getElementById("fileInput");
    const statusEl = document.getElementById("status");
    const queryInput = document.getElementById("queryInput");
    const searchBtn = document.getElementById("searchBtn");
    const resultsEl = document.getElementById("results");

    fileInput.addEventListener("change", () => {
      const file = fileInput.files[0];
      if (!file) {
        statusEl.textContent = "âš ï¸ Î”ÎµÎ½ ÎµÏ€Î¹Î»Î­Ï‡Î¸Î·ÎºÎµ Î±ÏÏ‡ÎµÎ¯Î¿.";
        lines = [];
        searchBtn.disabled = true;
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        const text = e.target.result;
        // Î”Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÏƒÎµ Î³ÏÎ±Î¼Î¼Î­Ï‚
        lines = text.split(/\r?\n/);
        statusEl.textContent = `âœ… Î¦Î¿ÏÏ„ÏÎ¸Î·ÎºÎµ Ï„Î¿ Î±ÏÏ‡ÎµÎ¯Î¿: ${file.name} â€” Î£ÏÎ½Î¿Î»Î¿ Î³ÏÎ±Î¼Î¼ÏÎ½: ${lines.length}`;
        searchBtn.disabled = false;
      };
      reader.onerror = function () {
        statusEl.textContent = "âŒ Î£Ï†Î¬Î»Î¼Î± ÎºÎ±Ï„Î¬ Ï„Î·Î½ Î±Î½Î¬Î³Î½Ï‰ÏƒÎ· Ï„Î¿Ï… Î±ÏÏ‡ÎµÎ¯Î¿Ï….";
        lines = [];
        searchBtn.disabled = true;
      };

      reader.readAsText(file, "UTF-8");
    });

    function highlight(text, query) {
      if (!query) return text;
      const q = query.toLowerCase();
      // Î‘Ï€Î»ÏŒ case-insensitive highlight
      return text.replace(new RegExp(q, "gi"), (match) => `<mark>${match}</mark>`);
    }

    function doSearch() {
      const query = queryInput.value.trim();
      if (!query) {
        resultsEl.innerHTML = "âš ï¸ Î“ÏÎ¬ÏˆÎµ Ï€ÏÏÏ„Î± ÎºÎ¬Ï€Î¿Î¹Î± Î»Î­Î¾Î· Î³Î¹Î± Î±Î½Î±Î¶Î®Ï„Î·ÏƒÎ·.";
        return;
      }
      if (!lines.length) {
        resultsEl.innerHTML = "âš ï¸ Î”ÎµÎ½ Î­Ï‡ÎµÎ¹ Ï†Î¿ÏÏ„Ï‰Î¸ÎµÎ¯ Î±ÏÏ‡ÎµÎ¯Î¿ ÎºÎµÎ¹Î¼Î­Î½Î¿Ï….";
        return;
      }

      const qLower = query.toLowerCase();
      const n = lines.length;
      const blocks = [];

      for (let i = 0; i < n; i++) {
        if (lines[i].toLowerCase().includes(qLower)) {
          const start = Math.max(0, i - contextLines);
          const end = Math.min(n, i + contextLines + 1);
          const snippetLines = lines.slice(start, end);
          let blockText = snippetLines.join("\n").trim();
          blockText = highlight(blockText, query);
          blocks.push(blockText);
        }
      }

      if (!blocks.length) {
        resultsEl.innerHTML = '<span class="no-results">â— Î”ÎµÎ½ Î²ÏÎ­Î¸Î·ÎºÎ±Î½ Î±Ï€Î¿Ï„ÎµÎ»Î­ÏƒÎ¼Î±Ï„Î± Î³Î¹Î±: "' + query + '"</span>';
        return;
      }

      resultsEl.innerHTML = "";
      blocks.forEach((block, idx) => {
        const div = document.createElement("div");
        div.className = "result-block";
        div.innerHTML = block;
        resultsEl.appendChild(div);
        if (idx < blocks.length - 1) {
          const d = document.createElement("div");
          d.className = "divider";
          resultsEl.appendChild(d);
        }
      });
    }

    searchBtn.addEventListener("click", doSearch);

    queryInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        doSearch();
      }
    });
  </script>
</body>
</html>
